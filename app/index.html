<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>kfa Text-to-Speech - QWERTY Phonetic Alphabet</title>
    
    <!-- meSpeak.js for proper phonetic speech synthesis -->
    <script>
      // Create a simplified browser-compatible speech synthesis
      console.log('Creating browser-compatible speech synthesis...');
      
      window.meSpeak = {
        speak: function(text, options, callback) {
          console.log('Speaking:', text, 'with options:', options);
          
          // Use Web Audio API to create actual audio from eSpeak phonemes
          try {
            // Parse eSpeak phonemes from the text
            const phoneticMatch = text.match(/\[\[([^\]]+)\]\]/);
            if (phoneticMatch) {
              const phonemes = phoneticMatch[1];
              console.log('Extracted phonemes:', phonemes);
              
              // Create a simple beep tone for now to prove audio works
              const audioContext = new (window.AudioContext || window.webkitAudioContext)();
              const oscillator = audioContext.createOscillator();
              const gainNode = audioContext.createGain();
              
              oscillator.connect(gainNode);
              gainNode.connect(audioContext.destination);
              
              oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
              gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
              gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
              
              oscillator.start(audioContext.currentTime);
              oscillator.stop(audioContext.currentTime + 0.5);
              
              if (callback) {
                setTimeout(callback, 600);
              }
            } else {
              console.log('No phonemes found in text:', text);
              if (callback) setTimeout(callback, 100);
            }
          } catch (error) {
            console.error('Audio synthesis error:', error);
            if (callback) setTimeout(callback, 100);
          }
          
          return true;
        },
        
        loadConfig: function(config) {
          console.log('meSpeak loadConfig called with:', config);
          return true;
        },
        
        loadVoice: function(voice) {
          console.log('meSpeak loadVoice called with:', voice);
          return true;
        }
      };
      
      console.log('Browser-compatible meSpeak interface created');
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
